# Changelog — Admin Storage debug panel

Дата: 2025-12-17

## Контекст / проблема
Навіть після оптимізацій резолву Storage URL у Network могли залишатися повторні запити `.../v0/b/<bucket>/o?name=...` (CORS/404). Щоб швидко ідентифікувати, **яке саме поле/колекція** ініціює виклики Storage SDK (ініціатор у DevTools часто показується як `connection.ts`), потрібна вбудована діагностика.

## Що було
- Було складно визначити джерело проблемного `artist/...png` (hero чи інша секція), бо в DevTools видно лише запит SDK без прив’язки до Firestore документа/поля.

## Що стало
- Додано мінімальний блок **Storage debug** в адмін-панелі.
- `getDownloadUrlIfGs()` тепер приймає `ctx` і логить події:
  - `call`, `cache`, `missing`, `inflight`, `resolved`, `error`
- У панелі видно TOP ключів `bucket/path` та останні події з `ctx`, що дозволяє одразу знайти: `photos/<id>.image_gs_url`, `artist_info/<id>.hero_image`, тощо.

## Файли
- Зміни коду: public/index.html
- Новий тест-чекліст: tests/admin-storage-debug-panel.md

## Як перевіряти
- Відкрити адмін-панель → Storage debug → Очистити → Hard Reload.
- Подивитись `lastCtx` для ключа `sunfixer-website.appspot.com/artist/...` і знайти реальне джерело.
